<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manipulação de CSV com JavaScript</title>
    <style>
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
            padding: 8px;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <h1>Manipulação de Arquivo CSV em JavaScript</h1>

    <!-- Campos de entrada para adicionar novos dados -->
    <div id="formulario">
        <h2>Adicionar Novo Usuário</h2>
        <label>ID: <input type="text" id="input-id"></label><br>
        <label>Usuário: <input type="text" id="input-usuario"></label><br>
        <label>Senha: <input type="text" id="input-senha"></label><br>
        <label>Email: <input type="email" id="input-email"></label><br>
        <label>Dados: <input type="text" id="input-dados"></label><br>
        <button onclick="adicionarUsuario()">Adicionar Usuário</button>
    </div>

    <!-- Tabela para exibir os dados carregados e atualizados -->
    <h2>Dados dos Usuários</h2>
    <table id="tabela-usuarios">
        <thead>
            <tr>
                <th>ID</th>
                <th>Usuário</th>
                <th>Senha</th>
                <th>Email</th>
                <th>Dados</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <!-- Inclua a biblioteca PapaParse -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>

    <script>
        let dados = []; // Array global para armazenar os dados do CSV

        // Função para carregar o CSV e exibir na tabela
        function carregarCSV() {
            fetch('usuarios.csv')
                .then(response => response.text())
                .then(csvText => {
                    // Parse do CSV para um array de objetos usando PapaParse
                    dados = Papa.parse(csvText, {
                        header: true,
                        skipEmptyLines: true
                    }).data;

                    exibirTabela();  // Exibe a tabela inicial
                })
                .catch(error => console.error('Erro ao carregar o CSV:', error));
        }

        // Função para exibir a tabela
        function exibirTabela() {
            const tabela = document.getElementById('tabela-usuarios').getElementsByTagName('tbody')[0];
            tabela.innerHTML = ''; // Limpa a tabela

            dados.forEach(linha => {
                const tr = document.createElement('tr');
                Object.values(linha).forEach(valor => {
                    const td = document.createElement('td');
                    td.textContent = valor;
                    tr.appendChild(td);
                });
                tabela.appendChild(tr);
            });
        }

        // Função para adicionar um novo usuário ao array e atualizar a tabela
        function adicionarUsuario() {
            const novoUsuario = {
                id: document.getElementById('input-id').value,
                usuario: document.getElementById('input-usuario').value,
                senha: document.getElementById('input-senha').value,
                email: document.getElementById('input-email').value,
                dados: document.getElementById('input-dados').value
            };

            // Adiciona o novo usuário ao array `dados`
            dados.push(novoUsuario);

            // Atualiza a exibição da tabela com o novo usuário
            exibirTabela();

            // Limpa os campos de input após a adição
            document.getElementById('input-id').value = '';
            document.getElementById('input-usuario').value = '';
            document.getElementById('input-senha').value = '';
            document.getElementById('input-email').value = '';
            document.getElementById('input-dados').value = '';
        }

        // Carrega o CSV ao carregar a página
        document.addEventListener('DOMContentLoaded', carregarCSV);
    </script>
</body>
</html>
